---
phase: 09-portal-admin-ux-polish
plan: 03
type: execute
wave: 2
depends_on: ["09-02"]
files_modified:
  - apps/web-portal/components/ui/drawer.tsx
  - apps/web-portal/components/dashboard/responsive-sidebar.tsx
  - apps/web-portal/app/dashboard/layout.tsx
  - apps/web-portal/hooks/use-media-query.ts
autonomous: true

must_haves:
  truths:
    - "On mobile (< 768px), sidebar is hidden and hamburger menu appears"
    - "Clicking hamburger menu opens drawer with full sidebar navigation"
    - "On desktop (>= 768px), sidebar is always visible"
    - "Drawer can be closed by clicking outside or swiping"
  artifacts:
    - path: "apps/web-portal/components/ui/drawer.tsx"
      provides: "shadcn/ui Drawer component"
      contains: "DrawerContent"
    - path: "apps/web-portal/components/dashboard/responsive-sidebar.tsx"
      provides: "Mobile drawer wrapper for sidebar"
      min_lines: 20
    - path: "apps/web-portal/app/dashboard/layout.tsx"
      provides: "Responsive layout with conditional sidebar/drawer"
      contains: "ResponsiveSidebar"
  key_links:
    - from: "responsive-sidebar.tsx"
      to: "drawer.tsx"
      via: "Drawer import"
      pattern: "import.*Drawer"
    - from: "layout.tsx"
      to: "responsive-sidebar.tsx"
      via: "Component import"
      pattern: "ResponsiveSidebar"
---

<objective>
Make the dashboard fully responsive with a mobile drawer for navigation.

Purpose: Enable mobile users to access all navigation through a slide-out drawer while preserving the desktop sidebar experience.
Output: Drawer component, responsive sidebar wrapper, and updated layout.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-portal-admin-ux-polish/09-RESEARCH.md
@apps/web-portal/app/dashboard/layout.tsx
@apps/web-portal/components/dashboard/sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add shadcn/ui Drawer component</name>
  <files>apps/web-portal/components/ui/drawer.tsx</files>
  <action>
Run the shadcn CLI to add the Drawer component:

```bash
cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npx shadcn@latest add drawer --yes
```

This will:
1. Install the vaul dependency if not present
2. Create components/ui/drawer.tsx with all necessary exports

If the CLI fails or you need to create manually, the Drawer component wraps vaul and exports:
- Drawer
- DrawerTrigger
- DrawerContent
- DrawerClose
- DrawerHeader
- DrawerFooter
- DrawerTitle
- DrawerDescription

After adding, verify the file exists and exports are correct.
  </action>
  <verify>
File exists: `ls -la /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal/components/ui/drawer.tsx`
  </verify>
  <done>
Drawer component is available at components/ui/drawer.tsx with proper exports.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create useMediaQuery hook and ResponsiveSidebar</name>
  <files>
    apps/web-portal/hooks/use-media-query.ts
    apps/web-portal/components/dashboard/responsive-sidebar.tsx
  </files>
  <action>
1. First, create the hooks directory if it doesn't exist and add useMediaQuery hook:

Create `apps/web-portal/hooks/use-media-query.ts`:
```tsx
'use client';

import { useState, useEffect } from 'react';

export function useMediaQuery(query: string): boolean {
  const [matches, setMatches] = useState(false);

  useEffect(() => {
    const media = window.matchMedia(query);

    // Set initial value
    setMatches(media.matches);

    // Create listener
    const listener = (event: MediaQueryListEvent) => {
      setMatches(event.matches);
    };

    // Add listener
    media.addEventListener('change', listener);

    // Cleanup
    return () => media.removeEventListener('change', listener);
  }, [query]);

  return matches;
}
```

2. Create `apps/web-portal/components/dashboard/responsive-sidebar.tsx`:
```tsx
'use client';

import { Menu } from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Drawer, DrawerContent, DrawerTrigger } from '@/components/ui/drawer';
import { Sidebar } from './sidebar';

interface ResponsiveSidebarProps {
  isAdmin?: boolean;
}

export function ResponsiveSidebar({ isAdmin }: ResponsiveSidebarProps) {
  return (
    <Drawer direction="left">
      <DrawerTrigger asChild>
        <Button variant="ghost" size="icon" className="md:hidden">
          <Menu className="h-5 w-5" />
          <span className="sr-only">Toggle navigation menu</span>
        </Button>
      </DrawerTrigger>
      <DrawerContent className="h-full w-64 p-0 rounded-none">
        <Sidebar isAdmin={isAdmin} />
      </DrawerContent>
    </Drawer>
  );
}
```

Key features:
- Uses shadcn/ui Drawer with direction="left" for side navigation
- DrawerTrigger shows hamburger menu icon
- md:hidden ensures trigger only shows on mobile
- sr-only provides accessibility label
- DrawerContent wraps the same Sidebar component used on desktop
- rounded-none removes default drawer corner rounding for edge-to-edge sidebar
  </action>
  <verify>
TypeScript compiles: `cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npx tsc --noEmit`
  </verify>
  <done>
useMediaQuery hook and ResponsiveSidebar component exist and compile without errors.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update dashboard layout for responsive design</name>
  <files>apps/web-portal/app/dashboard/layout.tsx</files>
  <action>
Update the dashboard layout to use responsive sidebar pattern:

1. Add import for ResponsiveSidebar:
   `import { ResponsiveSidebar } from '@/components/dashboard/responsive-sidebar';`

2. Replace the layout structure to:
   - Hide desktop sidebar on mobile with `hidden md:block`
   - Add mobile header with drawer trigger
   - Add padding-top on mobile to account for fixed header

Updated layout (replace the return statement):
```tsx
return (
  <div className="flex min-h-screen bg-background">
    {/* Desktop Sidebar - hidden on mobile */}
    <div className="hidden md:block">
      <Sidebar isAdmin={adminStatus} />
    </div>

    {/* Mobile Header with Drawer Trigger */}
    <div className="md:hidden fixed top-0 left-0 right-0 z-40 border-b bg-background px-4 py-3 flex items-center gap-3">
      <ResponsiveSidebar isAdmin={adminStatus} />
      <span className="font-semibold">Speak For Me</span>
    </div>

    {/* Main Content */}
    <main className="flex-1 overflow-auto pt-16 md:pt-0">
      <div className="p-6">
        {subscriptionBanner && (
          <SubscriptionBanner
            type={subscriptionBanner.type}
            message={subscriptionBanner.message}
          />
        )}
        {children}
      </div>
    </main>
  </div>
);
```

Key changes:
- `bg-gray-50 dark:bg-gray-900` changed to `bg-background` to use the warm cream
- Desktop sidebar wrapped with `hidden md:block`
- Mobile header added with `md:hidden` and `fixed` positioning
- Main content has `pt-16 md:pt-0` to offset mobile header height
- `h-screen` changed to `min-h-screen` for better mobile behavior
  </action>
  <verify>
Build succeeds and ResponsiveSidebar is integrated:
```bash
cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npm run build && grep -q 'ResponsiveSidebar' app/dashboard/layout.tsx && echo "ResponsiveSidebar integrated" || echo "ERROR: ResponsiveSidebar not found in layout"
```
  </verify>
  <done>
Dashboard layout is responsive: desktop shows fixed sidebar, mobile shows hamburger menu that opens drawer.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Drawer component exists at components/ui/drawer.tsx
3. ResponsiveSidebar component exists
4. Layout imports and uses ResponsiveSidebar (verified with grep)
5. Desktop shows sidebar, mobile shows hamburger menu
</verification>

<success_criteria>
- Mobile (< 768px): Sidebar hidden, hamburger menu visible, drawer opens on tap
- Desktop (>= 768px): Sidebar always visible, no hamburger menu
- Drawer contains full sidebar navigation including admin section
- Build succeeds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/09-portal-admin-ux-polish/09-03-SUMMARY.md`
</output>
