---
phase: 09-portal-admin-ux-polish
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web-portal/components/dashboard/nav-group.tsx
  - apps/web-portal/components/dashboard/nav-item.tsx
  - apps/web-portal/components/dashboard/sidebar.tsx
autonomous: true

must_haves:
  truths:
    - "Admin section in sidebar expands/collapses when clicked"
    - "Admin submenu shows Organizations, Users, Billing links when expanded"
    - "Chevron icon rotates when admin section is expanded"
    - "Nested nav items have appropriate indentation"
  artifacts:
    - path: "apps/web-portal/components/dashboard/nav-group.tsx"
      provides: "Collapsible navigation group component"
      min_lines: 30
      contains: "Collapsible"
    - path: "apps/web-portal/components/dashboard/sidebar.tsx"
      provides: "Sidebar with expandable admin navigation"
      contains: "NavGroup"
  key_links:
    - from: "nav-group.tsx"
      to: "@radix-ui/react-collapsible"
      via: "Radix Collapsible primitives"
      pattern: "CollapsibleTrigger|CollapsibleContent"
    - from: "sidebar.tsx"
      to: "nav-group.tsx"
      via: "NavGroup import"
      pattern: "import.*NavGroup"
---

<objective>
Create expandable admin navigation in the sidebar using Radix UI Collapsible.

Purpose: Enable admins to access Organizations, Users, and Billing pages through an expandable submenu that reduces visual clutter while maintaining discoverability.
Output: NavGroup component and updated sidebar with collapsible admin section.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-portal-admin-ux-polish/09-RESEARCH.md
@apps/web-portal/components/dashboard/sidebar.tsx
@apps/web-portal/components/dashboard/nav-item.tsx
@apps/web-portal/components/ui/collapsible.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update NavItem to support compact mode</name>
  <files>apps/web-portal/components/dashboard/nav-item.tsx</files>
  <action>
Modify the existing NavItem component to support nested navigation items:

1. **Add compact prop to interface:**
   - Add `compact?: boolean` to NavItemProps

2. **Make icon optional:**
   - Change `icon: LucideIcon` to `icon?: LucideIcon` in interface
   - Wrap icon rendering with conditional: `{Icon && <Icon className="w-5 h-5" />}`

3. **Update className for conditional padding:**
   - Replace fixed padding with: `compact ? 'px-3 py-2' : 'px-4 py-2.5'`
   - Compact mode uses smaller padding for nested submenu items

4. **Update function signature:**
   - Add `compact` to destructured props: `{ href, icon: Icon, label, compact }`
  </action>
  <verify>
TypeScript compiles: `cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npx tsc --noEmit`
  </verify>
  <done>
NavItem component supports optional `compact` prop for nested navigation items and optional icon.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create NavGroup collapsible component</name>
  <files>apps/web-portal/components/dashboard/nav-group.tsx</files>
  <action>
Create a new NavGroup component that uses Radix UI Collapsible for expandable navigation:

```tsx
'use client';

import { useState } from 'react';
import { ChevronDown, LucideIcon } from 'lucide-react';
import { Collapsible, CollapsibleContent, CollapsibleTrigger } from '@/components/ui/collapsible';
import { NavItem } from './nav-item';
import { cn } from '@/lib/utils';

interface NavGroupItem {
  href: string;
  label: string;
}

interface NavGroupProps {
  label: string;
  icon: LucideIcon;
  items: NavGroupItem[];
  defaultOpen?: boolean;
}

export function NavGroup({ label, icon: Icon, items, defaultOpen = false }: NavGroupProps) {
  const [isOpen, setIsOpen] = useState(defaultOpen);

  return (
    <Collapsible open={isOpen} onOpenChange={setIsOpen}>
      <CollapsibleTrigger className={cn(
        'flex w-full items-center justify-between gap-3 px-4 py-2.5',
        'text-sm font-medium rounded-lg transition-colors',
        'text-muted-foreground hover:bg-accent hover:text-accent-foreground',
        'outline-none focus-visible:ring-2 focus-visible:ring-ring'
      )}>
        <div className="flex items-center gap-3">
          <Icon className="w-5 h-5" />
          <span>{label}</span>
        </div>
        <ChevronDown className={cn(
          'w-4 h-4 transition-transform duration-200',
          isOpen && 'rotate-180'
        )} />
      </CollapsibleTrigger>
      <CollapsibleContent className="overflow-hidden data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down">
        <div className="ml-8 mt-1 space-y-1 pb-1">
          {items.map((item) => (
            <NavItem
              key={item.href}
              href={item.href}
              label={item.label}
              compact
            />
          ))}
        </div>
      </CollapsibleContent>
    </Collapsible>
  );
}
```

Key features:
- Uses Radix Collapsible for accessible expand/collapse
- ChevronDown icon rotates 180 degrees when open
- CollapsibleContent uses accordion animation classes
- Nested items are indented with ml-8 and use compact NavItem style
- Focus visible ring for keyboard navigation
  </action>
  <verify>
TypeScript compiles: `cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npx tsc --noEmit`
  </verify>
  <done>
NavGroup component exists that wraps Radix Collapsible with proper styling and animation.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update sidebar with expandable admin section</name>
  <files>apps/web-portal/components/dashboard/sidebar.tsx</files>
  <action>
Update the sidebar to use NavGroup for the admin section:

1. Add imports at the top:
   - `import { NavGroup } from './nav-group';`
   - `import { Building, UserCog, CreditCard } from 'lucide-react';`

2. Replace the current admin section (the div with `<NavItem href="/admin" ... />`) with:

```tsx
{isAdmin && (
  <div className="border-t border-border pt-4 mt-4">
    <NavGroup
      label="Admin"
      icon={Settings}
      defaultOpen={false}
      items={[
        { href: '/admin/organizations', label: 'Organizations' },
        { href: '/admin/users', label: 'Users' },
        { href: '/admin/billing', label: 'Billing' },
      ]}
    />
  </div>
)}
```

3. Update imports to include the new icons (Building, UserCog, CreditCard are imported but the NavGroup items array doesn't need icons since compact NavItem supports optional icons).

4. While editing, also update the hardcoded `bg-[#FFFDF7]` to use the CSS variable:
   - Change `bg-[#FFFDF7]` to `bg-background` since globals.css now sets --background to warm cream
  </action>
  <verify>
Build succeeds: `cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npm run build`
  </verify>
  <done>
Sidebar has expandable admin section with Organizations, Users, and Billing links using NavGroup component.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. NavGroup component file exists at components/dashboard/nav-group.tsx
3. Sidebar imports and uses NavGroup for admin section
4. NavItem supports compact prop
</verification>

<success_criteria>
- NavGroup component uses Radix UI Collapsible
- Admin section in sidebar expands/collapses on click
- Chevron rotates when expanded
- Admin submenu shows Organizations, Users, Billing links
- Build succeeds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/09-portal-admin-ux-polish/09-02-SUMMARY.md`
</output>
