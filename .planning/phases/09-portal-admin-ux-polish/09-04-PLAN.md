---
phase: 09-portal-admin-ux-polish
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web-portal/components/ui/skeleton.tsx
  - apps/web-portal/app/dashboard/loading.tsx
  - apps/web-portal/app/dashboard/error.tsx
  - apps/web-portal/app/admin/loading.tsx
  - apps/web-portal/app/admin/error.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard shows skeleton loading state while data loads"
    - "Admin pages show skeleton loading state while data loads"
    - "Errors in dashboard display friendly error message with retry button"
    - "Errors in admin pages display friendly error message with retry button"
  artifacts:
    - path: "apps/web-portal/components/ui/skeleton.tsx"
      provides: "Skeleton loading component"
      contains: "animate-pulse"
    - path: "apps/web-portal/app/dashboard/loading.tsx"
      provides: "Dashboard loading skeleton"
      contains: "Skeleton"
    - path: "apps/web-portal/app/dashboard/error.tsx"
      provides: "Dashboard error boundary"
      contains: "reset"
    - path: "apps/web-portal/app/admin/loading.tsx"
      provides: "Admin loading skeleton"
      contains: "Skeleton"
    - path: "apps/web-portal/app/admin/error.tsx"
      provides: "Admin error boundary"
      contains: "reset"
  key_links:
    - from: "loading.tsx"
      to: "skeleton.tsx"
      via: "Skeleton component import"
      pattern: "import.*Skeleton"
---

<objective>
Add loading states and error handling for dashboard and admin pages.

Purpose: Provide clear feedback to users during data loading and graceful error recovery when something goes wrong.
Output: Skeleton component, loading.tsx files, and error.tsx files for dashboard and admin routes.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-portal-admin-ux-polish/09-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add shadcn/ui Skeleton component</name>
  <files>apps/web-portal/components/ui/skeleton.tsx</files>
  <action>
Run the shadcn CLI to add the Skeleton component:

```bash
cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npx shadcn@latest add skeleton --yes
```

This creates a simple Skeleton component with animate-pulse for loading states.

If CLI fails, create manually:
```tsx
import { cn } from "@/lib/utils"

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn("animate-pulse rounded-md bg-muted", className)}
      {...props}
    />
  )
}

export { Skeleton }
```
  </action>
  <verify>
File exists: `ls -la /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal/components/ui/skeleton.tsx`
  </verify>
  <done>
Skeleton component is available at components/ui/skeleton.tsx.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create dashboard loading and error files</name>
  <files>
    apps/web-portal/app/dashboard/loading.tsx
    apps/web-portal/app/dashboard/error.tsx
  </files>
  <action>
1. Create `apps/web-portal/app/dashboard/loading.tsx`:
```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function DashboardLoading() {
  return (
    <div className="space-y-8">
      {/* Header skeleton */}
      <div>
        <Skeleton className="h-9 w-48 mb-2" />
        <Skeleton className="h-5 w-96" />
      </div>

      {/* Stats grid skeleton - matches 4-column grid on dashboard */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        {[...Array(4)].map((_, i) => (
          <div key={i} className="bg-card border border-border rounded-xl p-6">
            <div className="flex items-center justify-between mb-4">
              <Skeleton className="h-4 w-32" />
              <Skeleton className="h-5 w-5 rounded" />
            </div>
            <div className="space-y-2">
              <Skeleton className="h-9 w-20" />
              <Skeleton className="h-3 w-full" />
            </div>
          </div>
        ))}
      </div>

      {/* Content card skeleton */}
      <div className="bg-card border border-border rounded-xl p-6">
        <Skeleton className="h-6 w-48 mb-4" />
        <div className="space-y-3">
          <Skeleton className="h-4 w-full" />
          <Skeleton className="h-4 w-5/6" />
          <Skeleton className="h-4 w-4/6" />
        </div>
      </div>
    </div>
  );
}
```

2. Create `apps/web-portal/app/dashboard/error.tsx`:
```tsx
'use client';

import { useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { AlertCircle, RefreshCw } from 'lucide-react';

export default function DashboardError({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  useEffect(() => {
    // Log error to console (could add error reporting service later)
    console.error('Dashboard error:', error);
  }, [error]);

  return (
    <div className="flex min-h-[400px] flex-col items-center justify-center">
      <div className="text-center">
        <AlertCircle className="h-12 w-12 text-destructive mx-auto mb-4" />
        <h2 className="text-xl font-semibold mb-2">Something went wrong</h2>
        <p className="text-muted-foreground mb-6 max-w-md">
          We encountered an error loading your dashboard. Please try again.
        </p>
        <Button onClick={reset} variant="outline">
          <RefreshCw className="w-4 h-4 mr-2" />
          Try Again
        </Button>
      </div>
    </div>
  );
}
```

Key features:
- Loading skeleton matches dashboard layout structure
- Error displays AlertCircle icon (red/destructive color)
- Reset button calls error boundary's reset function
- Error logged to console for debugging
- 'use client' directive required for error.tsx
  </action>
  <verify>
TypeScript compiles: `cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npx tsc --noEmit`
  </verify>
  <done>
Dashboard has loading.tsx skeleton and error.tsx error boundary.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create admin loading and error files</name>
  <files>
    apps/web-portal/app/admin/loading.tsx
    apps/web-portal/app/admin/error.tsx
  </files>
  <action>
1. Create `apps/web-portal/app/admin/loading.tsx`:
```tsx
import { Skeleton } from '@/components/ui/skeleton';

export default function AdminLoading() {
  return (
    <div className="space-y-8">
      {/* Header skeleton */}
      <div>
        <Skeleton className="h-9 w-56 mb-2" />
        <Skeleton className="h-5 w-80" />
      </div>

      {/* Navigation cards skeleton - matches admin dashboard grid */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {[...Array(3)].map((_, i) => (
          <div key={i} className="bg-card border border-border rounded-xl p-6">
            <div className="flex items-center gap-4 mb-4">
              <Skeleton className="h-10 w-10 rounded-lg" />
              <div className="space-y-2">
                <Skeleton className="h-5 w-32" />
                <Skeleton className="h-3 w-48" />
              </div>
            </div>
            <Skeleton className="h-4 w-full" />
          </div>
        ))}
      </div>

      {/* Table skeleton */}
      <div className="bg-card border border-border rounded-xl">
        <div className="p-4 border-b border-border">
          <Skeleton className="h-6 w-40" />
        </div>
        <div className="divide-y divide-border">
          {[...Array(5)].map((_, i) => (
            <div key={i} className="p-4 flex items-center justify-between">
              <div className="flex items-center gap-3">
                <Skeleton className="h-8 w-8 rounded-full" />
                <div className="space-y-1">
                  <Skeleton className="h-4 w-32" />
                  <Skeleton className="h-3 w-48" />
                </div>
              </div>
              <Skeleton className="h-6 w-16 rounded-full" />
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}
```

2. Create `apps/web-portal/app/admin/error.tsx`:
```tsx
'use client';

import { useEffect } from 'react';
import { Button } from '@/components/ui/button';
import { AlertCircle, RefreshCw, Home } from 'lucide-react';
import Link from 'next/link';

export default function AdminError({
  error,
  reset,
}: {
  error: Error & { digest?: string };
  reset: () => void;
}) {
  useEffect(() => {
    // Log error to console (could add error reporting service later)
    console.error('Admin error:', error);
  }, [error]);

  return (
    <div className="flex min-h-[400px] flex-col items-center justify-center">
      <div className="text-center">
        <AlertCircle className="h-12 w-12 text-destructive mx-auto mb-4" />
        <h2 className="text-xl font-semibold mb-2">Admin Error</h2>
        <p className="text-muted-foreground mb-6 max-w-md">
          We encountered an error loading the admin panel. Please try again or return to the dashboard.
        </p>
        <div className="flex gap-3 justify-center">
          <Button onClick={reset} variant="outline">
            <RefreshCw className="w-4 h-4 mr-2" />
            Try Again
          </Button>
          <Button asChild variant="ghost">
            <Link href="/dashboard">
              <Home className="w-4 h-4 mr-2" />
              Dashboard
            </Link>
          </Button>
        </div>
      </div>
    </div>
  );
}
```

Key features:
- Admin loading matches admin page layout (3-column grid for nav cards, table structure)
- Admin error includes link back to dashboard as fallback
- Both use same component patterns for consistency
  </action>
  <verify>
Build succeeds: `cd /Users/christopherbartolo/Documents/GitHub/slack-speak-for-me/apps/web-portal && npm run build`
  </verify>
  <done>
Admin section has loading.tsx skeleton and error.tsx error boundary.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. Skeleton component exists at components/ui/skeleton.tsx
3. Dashboard loading.tsx and error.tsx exist
4. Admin loading.tsx and error.tsx exist
5. Error components have 'use client' directive
6. Loading components import and use Skeleton
</verification>

<success_criteria>
- Skeleton component available for reuse
- Dashboard shows skeleton while loading
- Admin shows skeleton while loading
- Errors display friendly message with retry button
- Build succeeds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/09-portal-admin-ux-polish/09-04-SUMMARY.md`
</output>
