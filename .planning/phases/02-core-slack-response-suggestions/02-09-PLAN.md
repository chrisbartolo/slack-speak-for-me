---
phase: 02-core-slack-response-suggestions
plan: 09
type: execute
wave: 4
depends_on: ["02-04", "02-05", "02-07", "02-08"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All Phase 2 success criteria are met end-to-end"
    - "AI suggestions work for all trigger types"
    - "Modal refinement flow functions correctly"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete Phase 2 implementation through end-to-end testing of all success criteria.

Purpose: Ensure the entire Slack response suggestion flow works correctly before marking Phase 2 complete.

Output: Verification of all success criteria from ROADMAP.md.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Verify all Phase 2 success criteria</name>
  <what-built>
Complete Slack AI response suggestion system including:
- Event handlers for app mentions, replies, and thread messages
- /watch and /unwatch slash commands
- "Help me respond" message shortcut
- AI suggestion generation with Claude
- Ephemeral message delivery with Copy/Refine buttons
- Refinement modal with multi-turn AI conversation
- Context retrieval from conversation history
  </what-built>
  <how-to-verify>
Verify each success criterion from ROADMAP.md:

**Prerequisites:**
1. Ensure PostgreSQL database is running and migrations are applied
2. Ensure Redis is running
3. Ensure app is installed to a test Slack workspace
4. Ensure environment variables are configured:
   - ANTHROPIC_API_KEY
   - SLACK_CLIENT_ID, SLACK_CLIENT_SECRET, SLACK_SIGNING_SECRET, SLACK_STATE_SECRET
   - DATABASE_URL
   - REDIS_HOST (optional, defaults to localhost)

**Criterion 1: Ephemeral suggestion when mentioned**
1. Add the app to a test channel
2. Run `/watch` in that channel
3. Have another user (or yourself from another account) @mention the bot
4. Verify: You receive an ephemeral message with a suggested response

**Criterion 2: Ephemeral suggestion when someone replies to your message**
1. In a watched channel, post a message
2. Have another user reply to your message
3. Verify: You receive an ephemeral suggestion for responding to the reply

**Criterion 3: Ephemeral suggestion in active thread**
1. In a watched channel, participate in a thread (post at least one message)
2. Have another user post a new message in that thread
3. Verify: You receive an ephemeral suggestion

**Criterion 4: "Help me respond" message action**
1. Right-click on any message in Slack
2. Select "Help me respond" from the message shortcuts menu
3. Verify: You receive "Generating a suggested response..." acknowledgment
4. Verify: Shortly after, you receive an ephemeral message with suggestion

**Criterion 5: Refine button and modal**
1. Click "Refine" on any suggestion ephemeral message
2. Verify: Modal opens with current suggestion displayed
3. Enter a refinement request (e.g., "Make it shorter")
4. Click "Refine"
5. Verify: Modal updates with refined suggestion
6. Try another refinement
7. Verify: Modal supports multiple rounds

**Criterion 6: Copy button**
1. Click "Copy to Clipboard" on any suggestion
2. Verify: Message updates with copyable text in code block
3. Verify: Instructions for copying are displayed
4. Click "Copy Final" in modal
5. Verify: Modal shows copyable text

**Criterion 7: Watch/Unwatch commands**
1. In a channel, run `/watch`
2. Verify: Ephemeral confirmation message
3. Run `/watch` again
4. Verify: Message says you're already watching
5. Run `/unwatch`
6. Verify: Confirmation message
7. Run `/unwatch` again
8. Verify: Message says you're not watching

**Criterion 8: AI reflects conversation context**
1. In a watched channel, have a brief conversation (2-3 messages)
2. Trigger a suggestion via any method
3. Verify: The suggestion references or relates to the conversation context

**Error cases to verify:**
- Suggestion generation works even if context retrieval fails (graceful degradation)
- Large messages are handled without crashing
- Rate limiting doesn't cause immediate failures
  </how-to-verify>
  <resume-signal>
Type "all verified" if all criteria pass, or describe which criteria failed and what errors occurred.
  </resume-signal>
</task>

</tasks>

<verification>
All Phase 2 success criteria from ROADMAP.md have been tested.
</verification>

<success_criteria>
- All 8 success criteria from ROADMAP.md verified
- No blocking errors encountered
- Ephemeral messages delivered correctly
- Modal refinement flow works
- AI suggestions are contextually relevant
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-slack-response-suggestions/02-09-SUMMARY.md`
</output>
