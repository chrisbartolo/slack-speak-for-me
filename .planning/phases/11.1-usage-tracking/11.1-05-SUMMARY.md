---
phase: 11.1-usage-tracking
plan: 05
status: complete
commits: ["d808583"]
---

## What Was Built

Admin usage analytics page at `/admin/usage` with org-wide usage data.

### Components Created

1. **`apps/web-portal/components/admin/usage-analytics.tsx`** — Client component with:
   - Summary cards row: Total Users, Total Suggestions, Average per User
   - Top Users table with Email, Suggestions Used, Included, % Used, Status columns
   - Status badges: Under Limit (green), Near Limit (yellow), Over Limit (red)
   - Empty state when no usage data

2. **`apps/web-portal/app/admin/usage/page.tsx`** — Server component:
   - Auth-gated via `requireAdmin()`
   - Fetches org usage via `getOrgUsageSummary()`
   - Handles missing organization gracefully
   - Billing period label formatted with Intl.DateTimeFormat

3. **`apps/web-portal/components/dashboard/sidebar.tsx`** — Added "Usage" to admin NavGroup after Billing

### Also Modified

- **`apps/web-portal/lib/billing/usage-queries.ts`** — Added `suggestionsIncluded` to `getOrgUsageSummary()` return type for per-user percentage calculations
- **`apps/web-portal/components/ui/table.tsx`** — Installed shadcn/ui Table component

## Verification

- TypeScript compiles without errors (pre-existing test file errors only)
- `getOrgUsageSummary` called in admin/usage/page.tsx
- `UsageAnalyticsTable` rendered with all required props
- `requireAdmin()` gates access
- `/admin/usage` link in admin sidebar section
